# 麻雀点数計算機 (Mahjong Score Calculator)

麻雀の手牌を入力して点数を自動計算するWebアプリケーションです。

**デプロイ先:** https://ryomeblog.github.io/mahjong-calculator-web/

## 技術スタック

- Vite 7 + React 19 + TypeScript (strict mode)
- Tailwind CSS 4
- React Router DOM 7
- GitHub Pages にデプロイ

## 開発

```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# TypeScriptチェック + プロダクションビルド
npm run build

# プロダクションビルドのプレビュー
npm run preview

# ESLint実行
npm run lint
```

## 使い方

### 1. ホーム画面から入力する方法

1. ホーム画面で「手牌を選択」をタップして14枚の手牌を入力します
2. 和了牌（最後の1枚）を含めた14枚を選択してください
3. 場風（東/南/西/北）と自風を設定します
4. 和了方法（ツモ/ロン）、リーチなどの条件を設定します
5. 必要に応じてドラ表示牌・裏ドラ表示牌・本場数を設定します
6. 「点数を計算」ボタンを押すと結果画面に遷移します

### 2. URLから直接結果を表示する方法（URL共有）

結果画面のURLにクエリパラメータを付けることで、URLを共有するだけで同じ結果を表示できます。

#### URL形式

```
https://ryomeblog.github.io/mahjong-calculator-web/result?h=<手牌>&w=<和了牌>&rw=<場風>&sw=<自風>&...
```

#### 牌の表記形式（天鳳形式）

天鳳で使用されている牌表記を採用しています。数字の後にスーツ文字を付けて表します。同じスーツの牌はまとめて記述できます。

| 種類 | 表記 | 牌 |
|---|---|---|
| 萬子(m) | `1m`〜`9m` | 一萬〜九萬 |
| 筒子(p) | `1p`〜`9p` | 一筒〜九筒 |
| 索子(s) | `1s`〜`9s` | 一索〜九索 |
| 赤五萬 | `0m` | 赤ドラの五萬 |
| 赤五筒 | `0p` | 赤ドラの五筒 |
| 赤五索 | `0s` | 赤ドラの五索 |
| 東 | `1z` | 東風 |
| 南 | `2z` | 南風 |
| 西 | `3z` | 西風 |
| 北 | `4z` | 北風 |
| 白 | `5z` | 白(三元牌) |
| 發 | `6z` | 發(三元牌) |
| 中 | `7z` | 中(三元牌) |

**グルーピング記法:** 同じスーツの牌は数字をまとめて書けます。

```
123m  → 一萬 二萬 三萬
456p  → 四筒 五筒 六筒
789s  → 七索 八索 九索
11z   → 東 東
```

**例:** `123m456p789s11z` は 一萬二萬三萬 四筒五筒六筒 七索八索九索 東東 で計11枚です。

**重要: 手牌(`h`)は必ず14枚になるようにしてください。** 14枚でない場合はエラーになります。

#### クエリパラメータ一覧

| パラメータ | 内容 | 必須 | 値 | 例 |
|---|---|---|---|---|
| `h` | 手牌（14枚） | Yes | 天鳳形式の牌表記 | `123m456p789s11155z` |
| `w` | 和了牌（1枚） | Yes | 天鳳形式の牌表記 | `5z` |
| `rw` | 場風 | Yes | `E`(東) / `S`(南) / `W`(西) / `N`(北) | `E` |
| `sw` | 自風 | Yes | `E`(東) / `S`(南) / `W`(西) / `N`(北) | `E` |
| `t` | ツモ | No | `1`=ツモ / `0`=ロン(default) | `1` |
| `r` | リーチ | No | `1`=あり / `0`=なし(default) | `1` |
| `dr` | ダブルリーチ | No | `1`=あり / `0`=なし(default) | `1` |
| `dora` | ドラ表示牌 | No | 天鳳形式の牌表記 | `5m1p` |
| `ura` | 裏ドラ表示牌 | No | 天鳳形式の牌表記 | `2p` |
| `hb` | 本場 | No | 数値(default `0`) | `1` |
| `ip` | 一発 | No | `1`=あり / `0`=なし(default) | `1` |
| `ck` | 槍槓 | No | `1`=あり / `0`=なし(default) | `1` |
| `rs` | 嶺上開花 | No | `1`=あり / `0`=なし(default) | `1` |
| `ht` | 海底摸月 | No | `1`=あり / `0`=なし(default) | `1` |
| `ho` | 河底撈魚 | No | `1`=あり / `0`=なし(default) | `1` |
| `th` | 天和 | No | `1`=あり / `0`=なし(default) | `1` |
| `ch` | 地和 | No | `1`=あり / `0`=なし(default) | `1` |

#### URL作成のサンプル

> 手牌(`h`)は**必ず14枚**にしてください。
> 数え方: スーツ文字(`m`,`p`,`s`,`z`)の前にある数字の個数を合計して14になればOKです。

---

**サンプル1: リーチ・ツモ（役牌・東）**

手牌: 一二三萬 四五六筒 七八九索 東東東 白白 （3+3+3+3+2=14枚）

```
h=123m456p789s11155z  (m:3枚 + p:3枚 + s:3枚 + z:5枚 = 14枚)
w=5z                   (和了牌=白)
rw=E                   (場風=東)
sw=E                   (自風=東)
t=1                    (ツモ)
r=1                    (リーチ)
```

URL:
```
/result?h=123m456p789s11155z&w=5z&rw=E&sw=E&t=1&r=1
```

---

**サンプル2: タンヤオ・ロン**

手牌: 二三四萬 五六七萬 三四五筒 六七八索 二二索 （6+3+3+2=14枚）

```
h=234567m345p22678s  (m:6枚 + p:3枚 + s:5枚 = 14枚)
w=2s                  (和了牌=二索)
rw=E                  (場風=東)
sw=S                  (自風=南)
```

URL:
```
/result?h=234567m345p22678s&w=2s&rw=E&sw=S
```

---

**サンプル3: リーチ・一発・ツモ + ドラあり**

手牌: 一一一萬 二三四筒 六七八索 九九九索 白白 （3+3+6+2=14枚）

```
h=111m234p678999s55z  (m:3枚 + p:3枚 + s:6枚 + z:2枚 = 14枚)
w=5z                   (和了牌=白)
rw=E                   (場風=東)
sw=S                   (自風=南)
t=1                    (ツモ)
r=1                    (リーチ)
ip=1                   (一発)
dora=3m                (ドラ表示牌=三萬 → ドラは四萬)
```

URL:
```
/result?h=111m234p678999s55z&w=5z&rw=E&sw=S&t=1&r=1&ip=1&dora=3m
```

---

**サンプル4: 赤ドラ入り**

赤五萬=`0m`、赤五筒=`0p`、赤五索=`0s` と表記します。

手牌: 二三四赤五萬 四五六筒 七八九索 東東東 白白 （4+3+3+3+2=15？→ 下記注意）

`0m` は赤五萬 **1枚** です。グルーピング内では各数字が1枚を表します。

```
h=2340m456p789s11155z  (m:4枚 + p:3枚 + s:3枚 + z:5枚 = 15枚) ← NG
h=230m456p789s11155z   (m:3枚 + p:3枚 + s:3枚 + z:5枚 = 14枚) ← OK
```

正しい例（三四赤五萬）: `340m` → 三萬・四萬・赤五萬の3枚

手牌: 三四赤五萬 四五六筒 七八九索 東東東 白白 （3+3+3+3+2=14枚）

URL:
```
/result?h=340m456p789s11155z&w=5z&rw=E&sw=E&t=1
```

---

**サンプル5: 七対子**

手牌: 一一萬 三三筒 五五索 東東 南南 白白 中中 （2+2+2+2+2+2+2=14枚）

```
h=11m33p55s11225577z  (m:2枚 + p:2枚 + s:2枚 + z:8枚 = 14枚)
w=7z                   (和了牌=中)
rw=E                   (場風=東)
sw=S                   (自風=南)
```

URL:
```
/result?h=11m33p55s11225577z&w=7z&rw=E&sw=S
```

---

**サンプル6: 国士無双**

手牌: 一九萬 一九筒 一九索 東南西北 白發中 中 （2+2+2+8=14枚）

```
h=19m19p19s12345677z  (m:2枚 + p:2枚 + s:2枚 + z:8枚 = 14枚)
w=7z                   (和了牌=中)
rw=E                   (場風=東)
sw=S                   (自風=南)
t=1                    (ツモ)
```

URL:
```
/result?h=19m19p19s12345677z&w=7z&rw=E&sw=S&t=1
```

---

#### 牌数の数え方のコツ

URLを手動で作成する際は、**必ず14枚になっているか確認**してください。14枚でない場合はエラーメッセージが表示されます。

数え方:
- スーツ文字(`m`, `p`, `s`, `z`)の**前にある数字の個数**がそのグループの牌数です
- すべてのグループの牌数を合計して14になればOKです

例: `123m456p789s11155z`
- `123m` → 3枚（一萬 二萬 三萬）
- `456p` → 3枚（四筒 五筒 六筒）
- `789s` → 3枚（七索 八索 九索）
- `11155z` → 5枚（東 東 東 白 白）
- 合計: 3 + 3 + 3 + 5 = **14枚** → OK

NG例: `123m456p789s1155z`
- 合計: 3 + 3 + 3 + 4 = **13枚** → エラー

## デプロイ

GitHub Pages に自動デプロイされます。

- `main` ブランチへのpushで `.github/workflows/deploy.yml` が実行されます
- `vite.config.ts` の `base` は `/mahjong-calculator-web/` に設定済み
- GitHub設定でPages SourceをGitHub Actionsに変更が必要

## ライセンス

MIT
